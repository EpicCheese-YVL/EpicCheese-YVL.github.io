<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>goofy jump game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: white;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }

        .game-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .header {
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header p {
            font-size: 1rem;
            color: #94a3b8;
        }

        .stats-bar {
            display: flex;
            gap: 2rem;
            margin-bottom: 1rem;
            padding: 1rem 2rem;
            background: rgba(15, 23, 42, 0.8);
            border-radius: 0.5rem;
            border: 2px solid #334155;
        }

        .stat {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .stat-label {
            color: #94a3b8;
            font-size: 0.875rem;
        }

        .stat-value {
            color: #fff;
            font-weight: bold;
            font-size: 1.25rem;
        }

        .canvas-wrapper {
            position: relative;
            display: inline-block;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            border-radius: 1rem;
        }

        #gameCanvas {
            border: 4px solid #334155;
            border-radius: 1rem;
            background: linear-gradient(180deg, #0f172a 0%, #1e1b4b 100%);
            display: block;
        }

        .overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: rgba(0, 0, 0, 0.85);
            border-radius: 1rem;
            backdrop-filter: blur(10px);
        }

        .overlay.hidden {
            display: none;
        }

        .overlay-content {
            text-align: center;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .won-title {
            font-size: 3rem;
            font-weight: bold;
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 1rem;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }

        .won-text {
            font-size: 1.25rem;
            color: #e2e8f0;
            margin-bottom: 1rem;
        }

        .final-stats {
            background: rgba(15, 23, 42, 0.5);
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .final-stats p {
            margin: 0.25rem 0;
            color: #cbd5e1;
        }

        .game-button {
            padding: 1rem 2rem;
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            color: white;
            border: none;
            border-radius: 0.75rem;
            font-size: 1.125rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 20px rgba(59, 130, 246, 0.4);
        }

        .game-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 30px rgba(59, 130, 246, 0.6);
        }

        .game-button:active {
            transform: translateY(0);
        }

        @media (max-width: 900px) {
            body {
                padding: 1rem;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .header p {
                font-size: 0.875rem;
            }

            .stats-bar {
                gap: 1rem;
                padding: 0.75rem 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="header">
            <h1>Star Jumper(Idk what to call this lol)</h1>
            <p>WASD to move(game created and updated by Veer)</p>
        </div>
        
        <div class="stats-bar">
            <div class="stat">
                <span class="stat-label">Level:</span>
                <span class="stat-value" id="levelDisplay">1</span>
            </div>
            <div class="stat">
                <span class="stat-label">ðŸ’° Coins:</span>
                <span class="stat-value" id="coinsDisplay">0</span>
            </div>
        </div>

        <div class="canvas-wrapper">
            <canvas id="gameCanvas" width="800" height="600"></canvas>
            
            <div id="wonScreen" class="overlay hidden">
                <div class="overlay-content">
                    <h2 class="won-title">u won!</h2>
                    <p class="won-text">more coming soon if u have suggestions contact me lol</p>
                    <div class="final-stats">
                        <p><strong>Total Coins Collected:</strong> <span id="finalCoins">0</span></p>
                    </div>
                    <button id="playAgainBtn" class="game-button">Play Again</button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Game constants
        const GRAVITY = 0.6;
        const JUMP_STRENGTH = -12;
        const MOVE_SPEED = 5;
        const CANVAS_WIDTH = 800;
        const CANVAS_HEIGHT = 600;

        // Sound system
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        
        function playSound(type) {
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            switch(type) {
                case 'jump':
                    oscillator.frequency.setValueAtTime(400, audioContext.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(600, audioContext.currentTime + 0.1);
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.1);
                    break;
                case 'coin':
                    oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(1200, audioContext.currentTime + 0.05);
                    gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.1);
                    break;
                case 'powerup':
                    oscillator.frequency.setValueAtTime(600, audioContext.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(1000, audioContext.currentTime + 0.15);
                    gainNode.gain.setValueAtTime(0.25, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.15);
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.15);
                    break;
                case 'win':
                    [0, 0.1, 0.2, 0.3].forEach((time, i) => {
                        const osc = audioContext.createOscillator();
                        const gain = audioContext.createGain();
                        osc.connect(gain);
                        gain.connect(audioContext.destination);
                        osc.frequency.setValueAtTime([523, 659, 784, 1047][i], audioContext.currentTime + time);
                        gain.gain.setValueAtTime(0.2, audioContext.currentTime + time);
                        gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + time + 0.3);
                        osc.start(audioContext.currentTime + time);
                        osc.stop(audioContext.currentTime + time + 0.3);
                    });
                    break;
            }
        }

        // Game state
        let gameState = 'playing';
        let level = 1;
        let keysPressed = new Set();
        let animationFrameId = null;
        let particles = [];
        let stars = [];
        let coins = [];
        let powerups = [];
        let movingPlatforms = [];
        let totalCoins = 0;

        // Player
        let player = {
            x: 50,
            y: 500,
            width: 32,
            height: 32,
            velocityX: 0,
            velocityY: 0,
            isJumping: false,
            squashFactor: 1,
            direction: 1,
            hasDoubleJump: false,
            doubleJumpUsed: false
        };

        // Level data
        let platforms = [];
        let goal = { x: 0, y: 0, width: 40, height: 40, rotation: 0 };

        // Canvas and context
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const wonScreen = document.getElementById('wonScreen');
        const playAgainBtn = document.getElementById('playAgainBtn');

        // Update displays
        function updateDisplays() {
            document.getElementById('levelDisplay').textContent = level;
            document.getElementById('coinsDisplay').textContent = totalCoins;
        }

        // Particle class
        class Particle {
            constructor(x, y, color, type = 'normal') {
                this.x = x;
                this.y = y;
                this.velocityX = (Math.random() - 0.5) * 4;
                this.velocityY = (Math.random() - 0.5) * 4 - 2;
                this.life = 1;
                this.decay = Math.random() * 0.02 + 0.01;
                this.color = color;
                this.size = Math.random() * 3 + 2;
                this.type = type;
            }

            update() {
                this.x += this.velocityX;
                this.y += this.velocityY;
                this.velocityY += 0.2;
                this.life -= this.decay;
            }

            draw(ctx) {
                ctx.save();
                ctx.globalAlpha = this.life;
                
                if (this.type === 'sparkle') {
                    ctx.fillStyle = this.color;
                    ctx.shadowBlur = 10;
                    ctx.shadowColor = this.color;
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                    ctx.fill();
                } else {
                    ctx.fillStyle = this.color;
                    ctx.fillRect(this.x, this.y, this.size, this.size);
                }
                
                ctx.restore();
            }
        }

        // Coin class
        class Coin {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.width = 20;
                this.height = 20;
                this.collected = false;
                this.rotation = 0;
                this.bobOffset = Math.random() * Math.PI * 2;
            }

            update(time) {
                this.rotation += 0.05;
                this.y += Math.sin(time * 0.05 + this.bobOffset) * 0.3;
            }

            draw(ctx, time) {
                if (this.collected) return;
                
                ctx.save();
                ctx.translate(this.x + this.width / 2, this.y + this.height / 2);
                
                // Glow
                const glow = ctx.createRadialGradient(0, 0, 0, 0, 0, 15);
                glow.addColorStop(0, 'rgba(251, 191, 36, 0.4)');
                glow.addColorStop(1, 'rgba(251, 191, 36, 0)');
                ctx.fillStyle = glow;
                ctx.fillRect(-15, -15, 30, 30);
                
                ctx.rotate(this.rotation);
                
                // Coin
                ctx.fillStyle = '#fbbf24';
                ctx.beginPath();
                ctx.arc(0, 0, 8, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.fillStyle = '#f59e0b';
                ctx.beginPath();
                ctx.arc(0, 0, 6, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.fillStyle = '#fbbf24';
                ctx.font = 'bold 10px sans-serif';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText('$', 0, 0);
                
                ctx.restore();
            }
        }

        // PowerUp class
        class PowerUp {
            constructor(x, y, type) {
                this.x = x;
                this.y = y;
                this.width = 24;
                this.height = 24;
                this.type = type; // 'doublejump'
                this.collected = false;
                this.rotation = 0;
                this.bobOffset = Math.random() * Math.PI * 2;
            }

            update(time) {
                this.rotation += 0.03;
                this.y += Math.sin(time * 0.05 + this.bobOffset) * 0.4;
            }

            draw(ctx, time) {
                if (this.collected) return;
                
                ctx.save();
                ctx.translate(this.x + this.width / 2, this.y + this.height / 2);
                ctx.rotate(this.rotation);
                
                // Glow
                const glow = ctx.createRadialGradient(0, 0, 0, 0, 0, 18);
                glow.addColorStop(0, 'rgba(139, 92, 246, 0.5)');
                glow.addColorStop(1, 'rgba(139, 92, 246, 0)');
                ctx.fillStyle = glow;
                ctx.fillRect(-18, -18, 36, 36);
                
                // Box
                const gradient = ctx.createLinearGradient(-12, -12, 12, 12);
                gradient.addColorStop(0, '#8b5cf6');
                gradient.addColorStop(1, '#6366f1');
                ctx.fillStyle = gradient;
                ctx.fillRect(-10, -10, 20, 20);
                
                // Symbol
                ctx.fillStyle = 'white';
                ctx.font = 'bold 12px sans-serif';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText('â¬†â¬†', 0, 0);
                
                ctx.restore();
            }
        }

        // Moving platform class
        class MovingPlatform {
            constructor(x, y, width, height, color, endX, endY, speed) {
                this.startX = x;
                this.startY = y;
                this.x = x;
                this.y = y;
                this.width = width;
                this.height = height;
                this.color = color;
                this.endX = endX;
                this.endY = endY;
                this.speed = speed;
                this.progress = 0;
                this.direction = 1;
            }

            update() {
                this.progress += this.speed * this.direction;
                
                if (this.progress >= 1) {
                    this.progress = 1;
                    this.direction = -1;
                } else if (this.progress <= 0) {
                    this.progress = 0;
                    this.direction = 1;
                }
                
                this.x = this.startX + (this.endX - this.startX) * this.progress;
                this.y = this.startY + (this.endY - this.startY) * this.progress;
            }
        }

        // Star background
        function createStars() {
            stars = [];
            for (let i = 0; i < 100; i++) {
                stars.push({
                    x: Math.random() * CANVAS_WIDTH,
                    y: Math.random() * CANVAS_HEIGHT,
                    size: Math.random() * 2,
                    speed: Math.random() * 0.5 + 0.1,
                    opacity: Math.random() * 0.5 + 0.3
                });
            }
        }

        // Level definitions
        function getLevelData(levelNum) {
            const levels = [
                // Level 1 - Tutorial
                {
                    platforms: [
                        { x: 0, y: 550, width: 800, height: 50, color: '#4a5568' },
                        { x: 150, y: 450, width: 120, height: 20, color: '#718096' },
                        { x: 350, y: 380, width: 120, height: 20, color: '#718096' },
                        { x: 550, y: 310, width: 120, height: 20, color: '#718096' },
                        { x: 400, y: 240, width: 150, height: 20, color: '#718096' },
                    ],
                    movingPlatforms: [],
                    coins: [
                        { x: 200, y: 420 },
                        { x: 400, y: 350 },
                        { x: 600, y: 280 }
                    ],
                    powerups: [],
                    playerStart: { x: 50, y: 500 },
                    goal: { x: 450, y: 180, width: 40, height: 40 }
                },
                // Level 2 - Gaps
                {
                    platforms: [
                        { x: 0, y: 550, width: 200, height: 50, color: '#4a5568' },
                        { x: 300, y: 550, width: 500, height: 50, color: '#4a5568' },
                        { x: 100, y: 450, width: 100, height: 20, color: '#718096' },
                        { x: 300, y: 380, width: 100, height: 20, color: '#718096' },
                        { x: 500, y: 310, width: 100, height: 20, color: '#718096' },
                        { x: 350, y: 240, width: 100, height: 20, color: '#718096' },
                        { x: 150, y: 170, width: 120, height: 20, color: '#718096' },
                    ],
                    movingPlatforms: [],
                    coins: [
                        { x: 140, y: 420 },
                        { x: 340, y: 350 },
                        { x: 540, y: 280 },
                        { x: 390, y: 210 }
                    ],
                    powerups: [],
                    playerStart: { x: 50, y: 500 },
                    goal: { x: 170, y: 110, width: 40, height: 40 }
                },
                // Level 3 - Moving platform intro
                {
                    platforms: [
                        { x: 0, y: 550, width: 150, height: 50, color: '#4a5568' },
                        { x: 650, y: 550, width: 150, height: 50, color: '#4a5568' },
                        { x: 150, y: 450, width: 80, height: 20, color: '#718096' },
                        { x: 450, y: 350, width: 100, height: 20, color: '#718096' },
                        { x: 500, y: 240, width: 80, height: 20, color: '#718096' },
                        { x: 650, y: 170, width: 140, height: 20, color: '#718096' },
                    ],
                    movingPlatforms: [
                        { startX: 280, startY: 380, width: 100, height: 15, color: '#10b981', endX: 380, endY: 380, speed: 0.008 }
                    ],
                    coins: [
                        { x: 190, y: 420 },
                        { x: 330, y: 350 },
                        { x: 490, y: 320 },
                        { x: 540, y: 210 }
                    ],
                    powerups: [],
                    playerStart: { x: 50, y: 500 },
                    goal: { x: 700, y: 110, width: 40, height: 40 }
                },
                // Level 4 - Double jump powerup
                {
                    platforms: [
                        { x: 0, y: 550, width: 120, height: 50, color: '#4a5568' },
                        { x: 200, y: 480, width: 90, height: 20, color: '#718096' },
                        { x: 450, y: 400, width: 90, height: 20, color: '#718096' },
                        { x: 650, y: 320, width: 100, height: 20, color: '#718096' },
                    ],
                    movingPlatforms: [],
                    coins: [
                        { x: 230, y: 450 },
                        { x: 480, y: 370 },
                        { x: 680, y: 290 }
                    ],
                    powerups: [
                        { x: 225, y: 430, type: 'doublejump' }
                    ],
                    playerStart: { x: 50, y: 500 },
                    goal: { x: 680, y: 260, width: 40, height: 40 }
                },
                // Level 5 - Zigzag with moving platforms
                {
                    platforms: [
                        { x: 0, y: 550, width: 120, height: 50, color: '#4a5568' },
                        { x: 170, y: 480, width: 90, height: 20, color: '#718096' },
                        { x: 590, y: 300, width: 90, height: 20, color: '#718096' },
                        { x: 200, y: 120, width: 100, height: 20, color: '#718096' },
                        { x: 350, y: 80, width: 120, height: 20, color: '#718096' },
                    ],
                    movingPlatforms: [
                        { startX: 310, startY: 420, width: 90, height: 15, color: '#10b981', endX: 450, endY: 360, speed: 0.008 },
                        { startX: 340, startY: 240, width: 90, height: 15, color: '#10b981', endX: 480, endY: 180, speed: 0.01 }
                    ],
                    coins: [
                        { x: 200, y: 450 },
                        { x: 380, y: 390 },
                        { x: 620, y: 270 },
                        { x: 410, y: 220 }
                    ],
                    powerups: [],
                    playerStart: { x: 40, y: 500 },
                    goal: { x: 390, y: 20, width: 40, height: 40 }
                },
                // Level 6 - Vertical challenge
                {
                    platforms: [
                        { x: 0, y: 550, width: 800, height: 50, color: '#4a5568' },
                        { x: 100, y: 470, width: 100, height: 15, color: '#718096' },
                        { x: 550, y: 470, width: 100, height: 15, color: '#718096' },
                        { x: 325, y: 310, width: 80, height: 15, color: '#718096' },
                        { x: 200, y: 230, width: 100, height: 15, color: '#718096' },
                        { x: 400, y: 230, width: 100, height: 15, color: '#718096' },
                        { x: 300, y: 150, width: 120, height: 15, color: '#718096' },
                    ],
                    movingPlatforms: [
                        { startX: 175, startY: 390, width: 80, height: 15, color: '#10b981', endX: 475, endY: 390, speed: 0.012 }
                    ],
                    coins: [
                        { x: 140, y: 440 },
                        { x: 590, y: 440 },
                        { x: 365, y: 280 },
                        { x: 240, y: 200 },
                        { x: 440, y: 200 }
                    ],
                    powerups: [
                        { x: 350, y: 360, type: 'doublejump' }
                    ],
                    playerStart: { x: 40, y: 500 },
                    goal: { x: 340, y: 90, width: 40, height: 40 }
                },
                // Level 7 - Speed run
                {
                    platforms: [
                        { x: 0, y: 550, width: 100, height: 50, color: '#4a5568' },
                        { x: 150, y: 480, width: 60, height: 15, color: '#718096' },
                        { x: 420, y: 360, width: 60, height: 15, color: '#718096' },
                        { x: 680, y: 240, width: 60, height: 15, color: '#718096' },
                        { x: 580, y: 180, width: 60, height: 15, color: '#718096' },
                        { x: 450, y: 120, width: 70, height: 15, color: '#718096' },
                    ],
                    movingPlatforms: [
                        { startX: 280, startY: 420, width: 60, height: 15, color: '#10b981', endX: 360, endY: 420, speed: 0.015 },
                        { startX: 560, startY: 300, width: 60, height: 15, color: '#10b981', endX: 660, endY: 300, speed: 0.02 }
                    ],
                    coins: [
                        { x: 180, y: 450 },
                        { x: 320, y: 390 },
                        { x: 600, y: 270 },
                        { x: 710, y: 210 }
                    ],
                    powerups: [],
                    playerStart: { x: 40, y: 500 },
                    goal: { x: 470, y: 60, width: 40, height: 40 }
                },
                // Level 8 - Complex
                {
                    platforms: [
                        { x: 0, y: 550, width: 80, height: 50, color: '#4a5568' },
                        { x: 130, y: 490, width: 60, height: 15, color: '#718096' },
                        { x: 340, y: 370, width: 60, height: 15, color: '#718096' },
                        { x: 220, y: 190, width: 70, height: 15, color: '#718096' },
                        { x: 100, y: 130, width: 60, height: 15, color: '#718096' },
                        { x: 700, y: 380, width: 80, height: 15, color: '#718096' },
                        { x: 680, y: 240, width: 100, height: 15, color: '#718096' },
                    ],
                    movingPlatforms: [
                        { startX: 240, startY: 430, width: 50, height: 15, color: '#10b981', endX: 320, endY: 430, speed: 0.015 },
                        { startX: 450, startY: 310, width: 50, height: 15, color: '#10b981', endX: 550, endY: 250, speed: 0.01 },
                        { startX: 600, startY: 450, width: 70, height: 15, color: '#10b981', endX: 650, endY: 450, speed: 0.02 }
                    ],
                    coins: [
                        { x: 160, y: 460 },
                        { x: 280, y: 400 },
                        { x: 500, y: 280 },
                        { x: 730, y: 350 },
                        { x: 710, y: 210 }
                    ],
                    powerups: [
                        { x: 370, y: 340, type: 'doublejump' }
                    ],
                    playerStart: { x: 30, y: 500 },
                    goal: { x: 710, y: 180, width: 40, height: 40 }
                },
                // Level 9 - Narrow platforms
                {
                    platforms: [
                        { x: 0, y: 550, width: 90, height: 50, color: '#4a5568' },
                        { x: 140, y: 490, width: 55, height: 12, color: '#718096' },
                        { x: 360, y: 390, width: 55, height: 12, color: '#718096' },
                        { x: 580, y: 290, width: 55, height: 12, color: '#718096' },
                        { x: 480, y: 240, width: 50, height: 12, color: '#718096' },
                        { x: 370, y: 190, width: 55, height: 12, color: '#718096' },
                        { x: 260, y: 140, width: 50, height: 12, color: '#718096' },
                        { x: 150, y: 90, width: 60, height: 12, color: '#718096' },
                    ],
                    movingPlatforms: [
                        { startX: 250, startY: 440, width: 50, height: 12, color: '#10b981', endX: 320, endY: 440, speed: 0.018 },
                        { startX: 470, startY: 340, width: 50, height: 12, color: '#10b981', endX: 540, endY: 340, speed: 0.015 }
                    ],
                    coins: [
                        { x: 170, y: 460 },
                        { x: 290, y: 410 },
                        { x: 390, y: 360 },
                        { x: 610, y: 260 },
                        { x: 180, y: 60 }
                    ],
                    powerups: [
                        { x: 400, y: 160, type: 'doublejump' }
                    ],
                    playerStart: { x: 30, y: 500 },
                    goal: { x: 160, y: 30, width: 40, height: 40 }
                },
                // Level 10 - Final challenge
                {
                    platforms: [
                        { x: 0, y: 550, width: 80, height: 50, color: '#4a5568' },
                        { x: 720, y: 550, width: 80, height: 50, color: '#4a5568' },
                        { x: 330, y: 420, width: 50, height: 12, color: '#718096' },
                        { x: 630, y: 300, width: 45, height: 12, color: '#718096' },
                        { x: 340, y: 180, width: 50, height: 12, color: '#718096' },
                        { x: 140, y: 100, width: 50, height: 12, color: '#718096' },
                        { x: 40, y: 60, width: 60, height: 12, color: '#718096' },
                    ],
                    movingPlatforms: [
                        { startX: 130, startY: 500, width: 50, height: 12, color: '#10b981', endX: 200, endY: 500, speed: 0.02 },
                        { startX: 230, startY: 460, width: 45, height: 12, color: '#10b981', endX: 280, endY: 460, speed: 0.018 },
                        { startX: 430, startY: 380, width: 45, height: 12, color: '#10b981', endX: 500, endY: 340, speed: 0.012 },
                        { startX: 540, startY: 260, width: 50, height: 12, color: '#10b981', endX: 600, endY: 220, speed: 0.01 },
                        { startX: 440, startY: 220, width: 45, height: 12, color: '#10b981', endX: 500, endY: 180, speed: 0.015 },
                        { startX: 240, startY: 140, width: 45, height: 12, color: '#10b981', endX: 290, endY: 140, speed: 0.02 }
                    ],
                    coins: [
                        { x: 165, y: 470 },
                        { x: 255, y: 430 },
                        { x: 360, y: 390 },
                        { x: 465, y: 350 },
                        { x: 570, y: 240 },
                        { x: 660, y: 270 },
                        { x: 370, y: 150 },
                        { x: 60, y: 30 }
                    ],
                    powerups: [
                        { x: 355, y: 390, type: 'doublejump' },
                        { x: 650, y: 270, type: 'doublejump' }
                    ],
                    playerStart: { x: 30, y: 500 },
                    goal: { x: 50, y: 0, width: 40, height: 40 }
                }
            ];
            
            return levels[levelNum - 1] || levels[0];
        }

        // Load level
        function loadLevel(levelNum) {
            const levelData = getLevelData(levelNum);
            platforms = levelData.platforms;
            goal = levelData.goal;
            player.x = levelData.playerStart.x;
            player.y = levelData.playerStart.y;
            player.velocityX = 0;
            player.velocityY = 0;
            player.isJumping = false;
            player.hasDoubleJump = false;
            player.doubleJumpUsed = false;
            particles = [];
            
            // Create coins
            coins = levelData.coins.map(c => new Coin(c.x, c.y));
            
            // Create powerups
            powerups = levelData.powerups.map(p => new PowerUp(p.x, p.y, p.type));
            
            // Create moving platforms
            movingPlatforms = levelData.movingPlatforms.map(p => 
                new MovingPlatform(p.startX, p.startY, p.width, p.height, p.color, p.endX, p.endY, p.speed)
            );
            
            updateDisplays();
        }

        // Check collision
        function checkCollision(rect1, rect2) {
            return (
                rect1.x < rect2.x + rect2.width &&
                rect1.x + rect1.width > rect2.x &&
                rect1.y < rect2.y + rect2.height &&
                rect1.y + rect1.height > rect2.y
            );
        }

        // Draw platform with gradient and shadow
        function drawPlatform(platform) {
            // Shadow
            ctx.fillStyle = 'rgba(0, 0, 0, 0.3)';
            ctx.fillRect(platform.x + 4, platform.y + 4, platform.width, platform.height);
            
            // Gradient
            const gradient = ctx.createLinearGradient(0, platform.y, 0, platform.y + platform.height);
            gradient.addColorStop(0, platform.color);
            gradient.addColorStop(1, '#1e293b');
            ctx.fillStyle = gradient;
            ctx.fillRect(platform.x, platform.y, platform.width, platform.height);
            
            // Highlight
            ctx.fillStyle = 'rgba(255, 255, 255, 0.1)';
            ctx.fillRect(platform.x, platform.y, platform.width, 3);
        }

        // Draw player with character design
        function drawPlayer() {
            ctx.save();
            
            // Shadow
            ctx.fillStyle = 'rgba(0, 0, 0, 0.3)';
            ctx.beginPath();
            ctx.ellipse(player.x + player.width / 2, player.y + player.height + 3, 
                       player.width / 2, 4, 0, 0, Math.PI * 2);
            ctx.fill();
            
            // Squash effect
            const squash = player.squashFactor;
            const squashHeight = player.height * squash;
            const squashY = player.y + (player.height - squashHeight);
            
            // Body gradient
            const gradient = ctx.createLinearGradient(0, squashY, 0, squashY + squashHeight);
            gradient.addColorStop(0, '#60a5fa');
            gradient.addColorStop(1, '#3b82f6');
            ctx.fillStyle = gradient;
            
            // Rounded rectangle body
            ctx.beginPath();
            const radius = 8;
            ctx.roundRect(player.x, squashY, player.width, squashHeight, radius);
            ctx.fill();
            
            // Highlight
            ctx.fillStyle = 'rgba(255, 255, 255, 0.4)';
            ctx.beginPath();
            ctx.roundRect(player.x + 4, squashY + 4, player.width - 8, squashHeight / 3, 4);
            ctx.fill();
            
            // Eyes
            const eyeY = squashY + squashHeight * 0.35;
            const eyeSize = 4;
            const eyeOffset = player.width * 0.25;
            
            ctx.fillStyle = 'white';
            ctx.beginPath();
            ctx.arc(player.x + eyeOffset, eyeY, eyeSize, 0, Math.PI * 2);
            ctx.arc(player.x + player.width - eyeOffset, eyeY, eyeSize, 0, Math.PI * 2);
            ctx.fill();
            
            ctx.fillStyle = '#1e293b';
            ctx.beginPath();
            ctx.arc(player.x + eyeOffset + (player.direction * 1), eyeY, eyeSize / 2, 0, Math.PI * 2);
            ctx.arc(player.x + player.width - eyeOffset + (player.direction * 1), eyeY, eyeSize / 2, 0, Math.PI * 2);
            ctx.fill();
            
            // Double jump indicator
            if (player.hasDoubleJump && !player.doubleJumpUsed) {
                ctx.fillStyle = '#8b5cf6';
                ctx.shadowBlur = 5;
                ctx.shadowColor = '#8b5cf6';
                ctx.beginPath();
                ctx.arc(player.x + player.width / 2, squashY - 5, 3, 0, Math.PI * 2);
                ctx.fill();
            }
            
            ctx.restore();
        }

        // Draw goal with animation
        function drawGoal() {
            ctx.save();
            
            // Rotate
            goal.rotation += 0.02;
            
            // Glow effect
            const glowGradient = ctx.createRadialGradient(
                goal.x + goal.width / 2, goal.y + goal.height / 2, 0,
                goal.x + goal.width / 2, goal.y + goal.height / 2, goal.width
            );
            glowGradient.addColorStop(0, 'rgba(251, 191, 36, 0.5)');
            glowGradient.addColorStop(1, 'rgba(251, 191, 36, 0)');
            ctx.fillStyle = glowGradient;
            ctx.fillRect(goal.x - 10, goal.y - 10, goal.width + 20, goal.height + 20);
            
            // Main goal
            ctx.translate(goal.x + goal.width / 2, goal.y + goal.height / 2);
            ctx.rotate(goal.rotation);
            
            const gradient = ctx.createLinearGradient(-goal.width / 2, -goal.height / 2, 
                                                     goal.width / 2, goal.height / 2);
            gradient.addColorStop(0, '#fbbf24');
            gradient.addColorStop(0.5, '#f59e0b');
            gradient.addColorStop(1, '#fbbf24');
            ctx.fillStyle = gradient;
            ctx.fillRect(-goal.width / 2, -goal.height / 2, goal.width, goal.height);
            
            // Star shape inside
            ctx.fillStyle = '#fff';
            ctx.beginPath();
            for (let i = 0; i < 5; i++) {
                const angle = (i * 4 * Math.PI) / 5 - Math.PI / 2;
                const x = Math.cos(angle) * 8;
                const y = Math.sin(angle) * 8;
                if (i === 0) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            }
            ctx.closePath();
            ctx.fill();
            
            ctx.restore();
            
            // Sparkle particles around goal
            if (Math.random() < 0.3) {
                particles.push(new Particle(
                    goal.x + Math.random() * goal.width,
                    goal.y + Math.random() * goal.height,
                    '#fbbf24',
                    'sparkle'
                ));
            }
        }

        // Game loop
        let time = 0;
        function gameLoop() {
            if (gameState !== 'playing') return;
            
            time++;
            
            // Handle input
            player.velocityX = 0;
            if (keysPressed.has('arrowleft') || keysPressed.has('a')) {
                player.velocityX = -MOVE_SPEED;
                player.direction = -1;
            }
            if (keysPressed.has('arrowright') || keysPressed.has('d')) {
                player.velocityX = MOVE_SPEED;
                player.direction = 1;
            }
            
            // Jump logic with double jump
            if ((keysPressed.has('arrowup') || keysPressed.has('w') || keysPressed.has(' '))) {
                if (!player.isJumping) {
                    player.velocityY = JUMP_STRENGTH;
                    player.isJumping = true;
                    player.squashFactor = 1.2;
                    playSound('jump');
                    
                    // Jump particles
                    for (let i = 0; i < 5; i++) {
                        particles.push(new Particle(
                            player.x + player.width / 2,
                            player.y + player.height,
                            '#60a5fa',
                            'normal'
                        ));
                    }
                } else if (player.hasDoubleJump && !player.doubleJumpUsed && !keysPressed.has('jumpHeld')) {
                    player.velocityY = JUMP_STRENGTH * 0.9;
                    player.doubleJumpUsed = true;
                    keysPressed.add('jumpHeld');
                    playSound('jump');
                    
                    // Double jump particles
                    for (let i = 0; i < 10; i++) {
                        particles.push(new Particle(
                            player.x + player.width / 2,
                            player.y + player.height / 2,
                            '#8b5cf6',
                            'sparkle'
                        ));
                    }
                }
            } else {
                keysPressed.delete('jumpHeld');
            }
            
            // Apply gravity
            player.velocityY += GRAVITY;
            
            // Update squash
            player.squashFactor += (1 - player.squashFactor) * 0.1;
            
            // Update position
            let oldX = player.x;
            let oldY = player.y;
            player.x += player.velocityX;
            player.y += player.velocityY;
            
            // Update moving platforms
            movingPlatforms.forEach(p => p.update());
            
            // Collision detection with all platforms
            let landed = false;
            let allPlatforms = [...platforms, ...movingPlatforms];
            
            allPlatforms.forEach(platform => {
                if (checkCollision(player, platform)) {
                    if (player.velocityY > 0 && oldY + player.height <= platform.y + 5) {
                        player.y = platform.y - player.height;
                        player.velocityY = 0;
                        player.isJumping = false;
                        player.doubleJumpUsed = false;
                        landed = true;
                        
                        // Move with moving platform
                        if (platform instanceof MovingPlatform) {
                            player.x += (platform.x - oldX);
                        }
                        
                        if (oldY + player.height < platform.y - 2) {
                            player.squashFactor = 0.7;
                            // Landing particles
                            for (let i = 0; i < 8; i++) {
                                particles.push(new Particle(
                                    player.x + Math.random() * player.width,
                                    player.y + player.height,
                                    '#94a3b8',
                                    'normal'
                                ));
                            }
                        }
                    }
                    else if (player.velocityY < 0 && oldY >= platform.y + platform.height - 5) {
                        player.y = platform.y + platform.height;
                        player.velocityY = 0;
                    }
                    else if (player.velocityX > 0) {
                        player.x = platform.x - player.width;
                    } else if (player.velocityX < 0) {
                        player.x = platform.x + platform.width;
                    }
                }
            });
            
            // Keep player in bounds
            if (player.x < 0) player.x = 0;
            if (player.x + player.width > CANVAS_WIDTH) player.x = CANVAS_WIDTH - player.width;
            
            // Check if player fell off
            if (player.y > CANVAS_HEIGHT) {
                const levelData = getLevelData(level);
                player.x = levelData.playerStart.x;
                player.y = levelData.playerStart.y;
                player.velocityX = 0;
                player.velocityY = 0;
                player.isJumping = false;
                player.hasDoubleJump = false;
                player.doubleJumpUsed = false;
                particles = [];
            }
            
            // Check coin collection
            coins.forEach(coin => {
                if (!coin.collected && checkCollision(player, coin)) {
                    coin.collected = true;
                    totalCoins++;
                    playSound('coin');
                    updateDisplays();
                    
                    // Coin particles
                    for (let i = 0; i < 15; i++) {
                        particles.push(new Particle(
                            coin.x + coin.width / 2,
                            coin.y + coin.height / 2,
                            '#fbbf24',
                            'sparkle'
                        ));
                    }
                }
            });
            
            // Check powerup collection
            powerups.forEach(powerup => {
                if (!powerup.collected && checkCollision(player, powerup)) {
                    powerup.collected = true;
                    if (powerup.type === 'doublejump') {
                        player.hasDoubleJump = true;
                    }
                    playSound('powerup');
                    
                    // Powerup particles
                    for (let i = 0; i < 20; i++) {
                        particles.push(new Particle(
                            powerup.x + powerup.width / 2,
                            powerup.y + powerup.height / 2,
                            '#8b5cf6',
                            'sparkle'
                        ));
                    }
                }
            });
            
            // Check if player reached goal
            if (checkCollision(player, goal)) {
                // Victory particles
                for (let i = 0; i < 30; i++) {
                    particles.push(new Particle(
                        goal.x + goal.width / 2,
                        goal.y + goal.height / 2,
                        ['#fbbf24', '#f59e0b', '#fff'][Math.floor(Math.random() * 3)],
                        'sparkle'
                    ));
                }
                
                playSound('win');
                
                if (level < 10) {
                    level++;
                    loadLevel(level);
                } else {
                    gameState = 'won';
                    document.getElementById('finalCoins').textContent = totalCoins;
                    wonScreen.classList.remove('hidden');
                }
            }
            
            // Update coins
            coins.forEach(coin => coin.update(time));
            
            // Update powerups
            powerups.forEach(powerup => powerup.update(time));
            
            // Update particles
            particles = particles.filter(p => {
                p.update();
                return p.life > 0;
            });
            
            // Update stars
            stars.forEach(star => {
                star.y += star.speed;
                if (star.y > CANVAS_HEIGHT) {
                    star.y = 0;
                    star.x = Math.random() * CANVAS_WIDTH;
                }
            });
            
            // Drawing
            // Background gradient
            const bgGradient = ctx.createLinearGradient(0, 0, 0, CANVAS_HEIGHT);
            bgGradient.addColorStop(0, '#0f172a');
            bgGradient.addColorStop(1, '#1e1b4b');
            ctx.fillStyle = bgGradient;
            ctx.fillRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);
            
            // Stars
            stars.forEach(star => {
                ctx.fillStyle = `rgba(255, 255, 255, ${star.opacity})`;
                ctx.beginPath();
                ctx.arc(star.x, star.y, star.size, 0, Math.PI * 2);
                ctx.fill();
            });
            
            // Platforms
            platforms.forEach(drawPlatform);
            movingPlatforms.forEach(drawPlatform);
            
            // Coins
            coins.forEach(coin => coin.draw(ctx, time));
            
            // Powerups
            powerups.forEach(powerup => powerup.draw(ctx, time));
            
            // Particles
            particles.forEach(p => p.draw(ctx));
            
            // Goal
            drawGoal();
            
            // Player
            drawPlayer();
            
            // Level info with glow
            ctx.save();
            ctx.shadowBlur = 10;
            ctx.shadowColor = '#3b82f6';
            ctx.fillStyle = '#ffffff';
            ctx.font = 'bold 24px sans-serif';
            ctx.fillText(`Level ${level}`, 20, 35);
            ctx.restore();
            
            animationFrameId = requestAnimationFrame(gameLoop);
        }

        // Restart game
        function restartGame() {
            level = 1;
            totalCoins = 0;
            gameState = 'playing';
            wonScreen.classList.add('hidden');
            loadLevel(level);
            updateDisplays();
            gameLoop();
        }

        // Event listeners
        window.addEventListener('keydown', (e) => {
            keysPressed.add(e.key.toLowerCase());
        });

        window.addEventListener('keyup', (e) => {
            keysPressed.delete(e.key.toLowerCase());
        });

        playAgainBtn.addEventListener('click', restartGame);

        // Initialize
        createStars();
        loadLevel(level);
        updateDisplays();
        gameLoop();
    </script>
</body>
</html>
